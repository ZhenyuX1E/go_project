# 代码

## 代码结构

### 分层 MVC

按层拆分和按功能拆分：

按层拆分 MVC：在 MVC 架构中，将服务中的不同组件按访问顺序，拆分成了 Model、View 和 Controller 三层。每层完成不同的功能：

- View（视图）：提供给用户的操作界面，用来处理数据的显示。
- Controller（控制器）：负责根据用户从 View 层输入的指令，选取 Model  层中的数据，然后对其进行相应的操作，产生最终结果。
- Model（模型）：应用程序中用于处理数据逻辑的部分。

<img src="figures/ed0c3dfyy52ac82539cb602eec9f0146.png" alt="img" style="zoom: 50%;" />

在 Go 项目中，按层拆分会带来很多问题。最大的问题是循环引用：相同功能可能在不同层被使用到，而这些功能又分散在不同的层中，很容易造成循环引用，所以不推荐。

### 按功能拆分

比如，一个订单系统，可以根据不同功能将其拆分成用户（user）、订单（order）和计费（billing）3 个模块，每一个模块提供独立的功能，功能更单一。

<img src="figures/0d65eb1363bf8055e209bc24d1d99ca5.png" alt="img" style="zoom:50%;" />

其目录结构如下：

```shell
$ tree --noreport -L 2 pkg
pkg
├── billing
├── order
│   └── order.go
└── user
```

相较于按层拆分，按功能拆分模块带来的好处也很好理解：不同模块，功能单一，可以实现高内聚低耦合。因为所有的功能只需要实现一次，引用逻辑清晰，会大大减少出现循环引用的概率。所以，有很多优秀的 Go 项目采用的都是按功能拆分的模块拆分方式，例如 Kubernetes、Docker、Helm、Prometheus 等。

## 代码规范

除了组织合理的代码结构这种方式外，编写高质量 Go 应用的另外一个行之有效的方法，是遵循 Go  语言代码规范来编写代码。

### 编码规范





### 最佳实践







